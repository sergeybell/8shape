 --- BIN FILE READ: 8shape_resonant_maps
  12134 INCLUDE '8shape_resonant_maps';
  12135   PROCEDURE PICK INDEX MAPARR SPNRARR;
  12136     VARIABLE I 1;
  12137     VARIABLE J 1;
  12138     LOOP I 1 TWOND;
  12139       MSC(I) := MAPARR(I, INDEX);
  12140       ENDLOOP;
  12141     LOOP I 1 3;
  12142       LOOP J 1 3;
  12143         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  12144         ENDLOOP;
  12145       ENDLOOP;
  12146     ENDPROCEDURE;
  12147   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  12148     VARIABLE J 1;
  12149     WRITE 6 '* '&ST(START);
  12150     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  12151     LOOP J (START+1) TO;
  12152       WRITE 6 '**       '&ST(J);
  12153       PICK J MAPARR SPNRARR; %PICK:12135
  12154       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  12155       UPDATE 1 1; %UPDATE: 1261
  12156       ENDLOOP;
  12157     LOOP J FROM (START-1);
  12158       WRITE 6 '**       '&ST(J);
  12159       PICK J MAPARR SPNRARR; %PICK:12135
  12160       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  12161       UPDATE 1 1; %UPDATE: 1261
  12162       ENDLOOP;
  12163     ENDPROCEDURE;
  12164   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  12165     VARIABLE NUM1 1;
  12166     VARIABLE NUM2 1;
  12167     VARIABLE OBJ 1;
  12168     IF COORD='X';
  12169       NUM1:=1;
  12170       NUM2:=2;
  12171       AL0:=0;
  12172       BET0:=20.0;
  12173       GAM0:=1.0/BET0;
  12174       ELSEIF COORD='Y';
  12175       NUM1:=3;
  12176       NUM2:=4;
  12177       AL0:=0;
  12178       BET0:=3;
  12179       GAM0:=1.0/BET0;
  12180       ELSEIF LO(1);
  12181       WRITE 6 'UNKNOWN COORDINATE';
  12182       ENDIF;
  12183     FIT AL0 BET0 GAM0;
  12184       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  12185       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  12186       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  12187       ENDFIT 1E-20 5000 1 OBJ;
  12188     ENDPROCEDURE;
  12189   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  12190     VARIABLE J 1;
  12191     VARIABLE NUM1 1;
  12192     VARIABLE NUM2 1;
  12193     IF COORD='X';
  12194       NUM1:=1;
  12195       NUM2:=2;
  12196       ELSEIF COORD='Y';
  12197       NUM1:=3;
  12198       NUM2:=4;
  12199       ELSEIF LO(1);
  12200       WRITE 6 'UNKNOWN COORDINATE';
  12201       ENDIF;
  12202     UM; %UM: 1488
  12203     BETS(1):=BET0;
  12204     OPENF 800 TAG 'REPLACE';
  12205     WRITE 800 ST(BETS(1))&'     '&ST(0);
  12206     LOOP J 1 NUM_ELE;
  12207       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:12147
  12208       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  12209       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  12210       UM; %UM: 1488
  12211       ENDLOOP;
  12212     CLOSEF 800;
  12213     ENDPROCEDURE;
  12214   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  12215     VARIABLE NUM1 1;
  12216     VARIABLE NUM2 1;
  12217     VARIABLE OBJ 1;
  12218     IF COORD='X';
  12219       NUM1:=1;
  12220       NUM2:=2;
  12221       D0:=0;
  12222       DPR0:=0;
  12223       ELSEIF COORD='Y';
  12224       NUM1:=3;
  12225       NUM2:=4;
  12226       D0:=0;
  12227       DPR0:=0;
  12228       ELSEIF LO(1);
  12229       WRITE 6 'UNKNOWN COORDINATE';
  12230       ENDIF;
  12231     FIT D0 DPR0;
  12232       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  12233       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  12234       ENDFIT 1E-20 5000 1 OBJ;
  12235     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  12236     WRITE 6 D0 DPR0;
  12237     ENDPROCEDURE;
  12238   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  12239     VARIABLE J 1;
  12240     VARIABLE NUM1 1;
  12241     VARIABLE NUM2 1;
  12242     IF COORD='X';
  12243       NUM1:=1;
  12244       NUM2:=2;
  12245       ELSEIF COORD='Y';
  12246       NUM1:=3;
  12247       NUM2:=4;
  12248       ELSEIF LO(1);
  12249       WRITE 6 'UNKNOWN COORDINATE';
  12250       ENDIF;
  12251     UM; %UM: 1488
  12252     DS(1):=D0;
  12253     OPENF 800 TAG 'REPLACE';
  12254     WRITE 800 ST(DS(1))&'     '&ST(0);
  12255     LOOP J 1 NUM_ELE;
  12256       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:12147
  12257       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  12258       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  12259       UM; %UM: 1488
  12260       ENDLOOP;
  12261     CLOSEF 800;
  12262     ENDPROCEDURE;
  12263   PROCEDURE MAIN;
  12264     VARIABLE GAMMA 1;
  12265     VARIABLE SGX1 1;
  12266     VARIABLE SGX2 1;
  12267     VARIABLE SGY1 1;
  12268     VARIABLE SGY2 1;
  12269     VARIABLE EB1 1;
  12270     VARIABLE ALPHAX0 1;
  12271     VARIABLE BETAX0 1;
  12272     VARIABLE GAMMAX0 1;
  12273     VARIABLE BETAXS 1 500;
  12274     VARIABLE ALPHAY0 1;
  12275     VARIABLE BETAY0 1;
  12276     VARIABLE GAMMAY0 1;
  12277     VARIABLE BETAYS 1 500;
  12278     VARIABLE DISPX0 1;
  12279     VARIABLE DISPXPR0 1;
  12280     VARIABLE DISPXS 1 500;
  12281     VARIABLE DISPY0 1;
  12282     VARIABLE DISPYPR0 1;
  12283     VARIABLE DISPYS 1 500;
  12284     VARIABLE MAPARR1 1000 6 500;
  12285     VARIABLE SPNRARR1 1000 3 3 500;
  12286     VARIABLE NUM_ELE 1;
  12287     VARIABLE TILT 48;
  12288     GAMMA := 1.143914 ;
  12289     NUM_ELE := 480;
  12290     OV 3 3 0; %OV:  969
  12291     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10611
  12292     SGX1 :=  0.0;
  12293     SGY1  := 0.0;
  12294     SGX2 :=  0.0;
  12295     SGY2  := 0.0;
  12296     BETAX0:=14.8105 ;
  12297     ALPHAX0:=0.00000563091 ;
  12298     BETAY0:=11.4173 ;
  12299     ALPHAY0:=-0.00294197 ;
  12300     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  12301     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  12302     DISPX0:=-0.00411573;
  12303     DISPXPR0:=0.000111827;
  12304     DISPY0:=0.0;
  12305     DISPYPR0:=0.0;
  12306     LATTICE SGX1 SGY1 SGX2 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10648

  12307     PM 6; %PM: 1574
  12308     WRITE 6 '++++++++++ Magnetic Rigidity';
  12309     WRITE 6 CONS(CHIM);
  12310     WRITE 6 ME(3,6); %ME:  516
  12311     BETS 'BETAX' 'X' NUM_ELE ALPHAX0 BETAX0 GAMMAX0 BETAXS MAPARR1 SPN
                  RARR1; %BETS:12189
  12312     BETS 'BETAY' 'Y' NUM_ELE ALPHAY0 BETAY0 GAMMAY0 BETAYS MAPARR1 SPN
                  RARR1; %BETS:12189
  12313     ENDPROCEDURE;
  12314   PROCEDURE RUN;
  12315     MAIN; %MAIN:12263
  12316     ENDPROCEDURE;
  12317   RUN; %RUN:12314
